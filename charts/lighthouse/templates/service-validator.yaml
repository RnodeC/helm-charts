{{- $lhrole := include "lighthouse.lhrole" . -}}
{{- if eq $lhrole "validator" -}}
---
apiVersion: v1
kind: Service
metadata:
  name: lighthouse-validator
  labels:
{{ include "lighthouse.labels" . | indent 4 }}
{{ include "lighthouse.validator-labels" . | indent 4 }}
spec:
  type: ClusterIP
  ports:
    {{ if .Values.lighthouse.http.enabled -}}
    - port: 5052
      targetPort: http
      protocol: TCP
      name: http
    {{- end }}
    - port: 9000
      targetPort: tcppeer
      protocol: TCP
      name: tcppeer
    - port: 9000
      targetPort: udppeer
      protocol: UDP
      name: udppeer
    {{- if .Values.lighthouse.metrics.enabled }}
    - port: 5064
      targetPort: metrics
      name: metrics
      protocol: TCP
    {{- end }}
  selector:
{{ include "lighthouse.labels" . | indent 4 }}
{{ include "lighthouse.validator-labels" . | indent 4 }}
{{- end }}
